import time
import logging
import random
import sys
import utils._sec
from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from parsers.page_parser import PageParser
from parsers.marks_parser import MarksPage
from parsers.messages_parser import MessagesPage
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.common.keys import Keys
from utils.filer import FileOperations
from utils.markslogic import MarksLogic
from utils.Messenger import Message
from utils.messages_logic import MessagesLogic



MARKS_CONST_4394568 = {"Biologia": [{"mark_value": "3+", "factor": "5", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-06", "comment": "sk\u00f3ra- pow\u0142oka organizmu", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "odpowied\u017a ustna", "mark_date": "2021-10-12", "comment": "szkielet", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "3", "average": "tak", "category": "praca na lekcji", "mark_date": "2021-10-25", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "5", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-01", "comment": "aparat ruchu", "correction": "0", "semester": "1"}, {"mark_value": "2", "factor": "5", "average": "tak", "category": "sprawdzian", "mark_date": "2021-12-07", "comment": "uk\u0142ad pokarmowy", "correction": "0", "semester": "1"}], "Chemia": [{"mark_value": "5", "factor": "3", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-09-23", "comment": "w\u0142a\u015bciwo\u015bci substancji", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-09-30", "comment": "g\u0119sto\u015b\u0107-zadania", "correction": "0", "semester": "1"}, {"mark_value": "2", "factor": "5", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-19", "comment": "substancje i ich przemiany", "correction": "0", "semester": "1"}, {"mark_value": "2+", "factor": "5", "average": "tak", "category": "sprawdzian", "mark_date": "2021-12-06", "comment": "budowa atomu", "correction": "0", "semester": "1"}], "Doradztwo zawodowe": [], "Fizyka": [{"mark_value": "4", "factor": "2", "average": "tak", "category": "Karta pracy Poj\u0119cia, pomiary, b\u0142\u0119dy pomiar\u00f3w", "mark_date": "2021-10-03", "comment": "6,5/9,5 pkt", "correction": "0", "semester": "1"}, {"mark_value": "2", "factor": "2", "average": "tak", "category": "Karta pracy zamiana jednostek, g\u0119sto\u015b\u0107, masa, ci\u0119\u017car", "mark_date": "2021-10-28", "comment": "4,5/11 pkt", "correction": "0", "semester": "1"}, {"mark_value": "2+", "factor": "2", "average": "tak", "category": "Poprawa Karty pracy", "mark_date": "2021-11-09", "comment": "KP: Masa, ci\u0119\u017car, g\u0119sto\u015b\u0107, zamiana jednostek<br />", "correction": "0", "semester": "1"}, {"mark_value": "3+", "factor": "3", "average": "tak", "category": "Sprawdzian - Pomiary, zamiana jednostek, g\u0119sto\u015b\u0107, ci\u0119\u017car, ci\u015bnienie , ", "mark_date": "2021-11-30", "comment": "20,5/32 pkt", "correction": "0", "semester": "1"}], "Geografia": [{"mark_value": "3-", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-08", "comment": "dzia\u0142 I", "correction": "0", "semester": "1"}, {"mark_value": "4-", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-17", "comment": "0", "correction": "3- (sprawdzian)", "semester": "1"}, {"mark_value": "4", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-17", "comment": "T:1,2,3", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "2", "average": "tak", "category": "odpowied\u017a ustna", "mark_date": "2021-11-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-22", "comment": "dzia\u0142 II ", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-29", "comment": "prezentacja - ochrona przeciwpowodziowa", "correction": "0", "semester": "1"}, {"mark_value": "3+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-30", "comment": "klimat ", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-12-10", "comment": "wody powierzchniowe ", "correction": "0", "semester": "1"}], "Godzina wychowawcza": [], "Historia": [{"mark_value": "3", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-18", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-05", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-15", "comment": "0", "correction": "0", "semester": "1"}], "Informatyka": [{"mark_value": "4", "factor": "1", "average": "tak", "category": "Karta pracy. Budowa i dzia\u0142anie sieci komputerowej", "mark_date": "2021-10-04", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "Budowa i dzia\u0142anie sieci komputerowej-\u0107wiczenia", "mark_date": "2021-10-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "HTML -szkielet strony", "mark_date": "2021-11-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "Test.  HTML- szkielet strony, formatowanie tekstu.", "mark_date": "2021-11-22", "comment": "0", "correction": "0", "semester": "1"}], "J\u0119zyk angielski": [{"mark_value": "4", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-14", "comment": "PresentSimple", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-10-15", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-25", "comment": "Present Continuous+ clothes ", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-10-28", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-14", "comment": "unit2", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-21", "comment": "instaling/pa\u017adziernik", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "odpowied\u017a ustna", "mark_date": "2021-12-03", "comment": "regular verbs", "correction": "0", "semester": "1"}], "J\u0119zyk niemiecki": [{"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-09-10", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-05", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-10-12", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "2", "factor": "1", "average": "tak", "category": "inna", "mark_date": "2021-11-02", "comment": "instaling", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-09", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-19", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "inna", "mark_date": "2021-12-01", "comment": "instaling", "correction": "0", "semester": "1"}, {"mark_value": "3+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-12-07", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "odpowied\u017a ustna", "mark_date": "2021-12-10", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "0", "average": "nie", "category": "\u015br\u00f3droczna", "mark_date": "2021-12-14", "comment": "0", "correction": "0", "semester": "1"}], "J\u0119zyk polski": [{"mark_value": "+", "factor": "0", "average": "0", "category": "zadanie", "mark_date": "2021-09-09", "comment": "wszystko o czasowniku", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-09-14", "comment": "znajomo\u015b\u0107 zasad ortograficznych i ich wykorzystanie", "correction": "0", "semester": "1"}, {"mark_value": "5+", "factor": "0", "average": "nie", "category": "praca w grupach", "mark_date": "2021-09-27", "comment": "Interpretacja Czego chcesz od nas Panie", "correction": "0", "semester": "1"}, {"mark_value": "3+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-09-28", "comment": "Fraszki <br />", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-07", "comment": "DZIADY - ZNAJOMO\u015a\u0106 TRE\u015aCI", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-10", "comment": "Gramatyka i stylistyka<br />", "correction": "0", "semester": "1"}, {"mark_value": "4-", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-10-11", "comment": "opowiadanie - spotkanie z bohaterem literackim", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-10-27", "comment": "opowiadanie - Dziady cz.II<br />", "correction": "0", "semester": "1"}, {"mark_value": "4-", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-27", "comment": "dramat/dramat romantyczny/Dziady cz.II/plan wydarze\u0144/symbol/uniwersalne przes\u0142anie", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-19", "comment": "\u015awitezianka", "correction": "0", "semester": "1"}, {"mark_value": "3+", "factor": "2", "average": "tak", "category": "odpowied\u017a ustna", "mark_date": "2021-12-01", "comment": "tre\u015b\u0107 Balladyna", "correction": "0", "semester": "1"}], "Matematyka": [{"mark_value": "3", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-09-27", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-07", "comment": "0", "correction": "3 (kartk\u00f3wka)", "semester": "1"}, {"mark_value": "4", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-11", "comment": "Kartk\u00f3wka 2 - Liczby ujemne, o\u015b liczbowa", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-21", "comment": "Sprawdzian 1 - Liczby i dzia\u0142ania", "correction": "0", "semester": "1"}, {"mark_value": "4+", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-03", "comment": "0", "correction": "3 (sprawdzian)", "semester": "1"}, {"mark_value": "6", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-26", "comment": "Kartk\u00f3wka 3 - Procenty i u\u0142amki", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-04", "comment": "Kartk\u00f3wka 4 - Jaki to procent?", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "3-", "factor": "2", "average": "tak", "category": "odpowied\u017a ustna", "mark_date": "2021-11-15", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-17", "comment": "Kartk\u00f3wka 5 - Podwy\u017cki i obni\u017cki", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-24", "comment": "Sprawdzian 2 - Procenty", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-12-02", "comment": "0", "correction": "3 (sprawdzian)", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-12-06", "comment": "Kartk\u00f3wka 6 - Obliczenia procentowe", "correction": "0", "semester": "1"}], "Muzyka": [{"mark_value": "2+", "factor": "1", "average": "tak", "category": "piosenka", "mark_date": "2021-10-27", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "prezentacja multimedialna", "mark_date": "2021-12-01", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-12-08", "comment": "0", "correction": "0", "semester": "1"}], "Plastyka": [{"mark_value": "np", "factor": "0", "average": "0", "category": "nieprzygotowany", "mark_date": "2021-10-20", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "0", "average": "nie", "category": "dzia\u0142alno\u015b\u0107 tw\u00f3rcza", "mark_date": "2021-11-03", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4-", "factor": "0", "average": "nie", "category": "grafika", "mark_date": "2021-11-03", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "0", "average": "nie", "category": "kompozycja", "mark_date": "2021-11-03", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5-", "factor": "0", "average": "nie", "category": "kola\u017c", "mark_date": "2021-11-24", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "2", "factor": "0", "average": "nie", "category": "rze\u017aba", "mark_date": "2021-12-08", "comment": "0", "correction": "0", "semester": "1"}], "Religia": [{"mark_value": "-", "factor": "0", "average": "0", "category": "zadanie", "mark_date": "2021-09-09", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-09-21", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "1", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-11-30", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-12-09", "comment": "0", "correction": "1 (zadanie)", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-30", "comment": "0", "correction": "0", "semester": "1"}], "Wychowanie fizyczne": [{"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-10-01", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "0", "average": "nie", "category": "Tor przeszk\u00f3d ", "mark_date": "2021-10-20", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "0", "average": "nie", "category": "Siatk\u00f3wka sprawdzian umiej\u0119tno\u015bci.", "mark_date": "2021-10-27", "comment": "0", "correction": "0", "semester": "1"}], "Zaj\u0119cia rozwijaj\u0105ce uzdolnienia": []}
MESSAGES_CONST_4394568 = [{'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Nauczanie zdalne 7a cd...', 'date': '2021-12-16 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Nauczanie zdalne 7a cd...', 'date': '2021-12-15 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Nauczanie zdalne 7a cd...', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Nauczanie zdalne 7a', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Nauczanie zdalne 7a', 'date': '2021-12-13 12:55:55'}, {'author': 'Ostrowski Aleksander (Ostrowski Aleksander)', 'title': 'Re: Oceny z muzyki', 'date': '2021-12-13 12:55:55'}, {'author': 'Boczar Agnieszka (Boczar Agnieszka)', 'title': 'Re: prośba o reset hasla rafal_bronikowski@spwb.pl', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Pilna informacja -,,Dzień otwarty', 'date': '2021-12-13 12:55:55'}, {'author': 'Kołodziej Agnieszka (Kołodziej Agnieszka)', 'title': '25 listopada - odwołane zajęcia dodatkowe', 'date': '2021-12-13 12:55:55'}, {'author': 'Zawadzka Agata (Zawadzka Agata)', 'title': 'Wyjazd do kina', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Dzień Otwarty dla Rodziców- 1XII 2021', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Wiadomość usunięta przez nadawcę w dniu 2021-11-23 15:01:08', 'date': '2021-12-13 12:55:55'}, {'author': 'administrator (administrator Monika)', 'title': 'KR_przyjazd dentobusu w dniach 10, 13 i 14 grudnia 2021', 'date': '2021-12-13 12:55:55'}, {'author': 'administrator (administrator Monika)', 'title': 'Szkolenia dla rodziców i dzieci z obszaru bezpieczeństwa .', 'date': '2021-12-13 12:55:55'}, {'author': 'Bielec Justyna (Bielec Justyna)', 'title': 'Spotkanie czytelnicze - głośne czytanie Dziadów cz.II', 'date': '2021-12-13 12:55:55'}, {'author': 'Bielec Justyna (Bielec Justyna)', 'title': 'Wiadomość usunięta przez nadawcę w dniu 2021-10-27 14:15:47', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Procedury bezpieczeństwa', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Spotkanie z Rodzicami klas 4-8', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Informacja pilna!!!', 'date': '2021-12-13 12:55:55'}, {'author': 'Ostrowski Aleksander (Ostrowski Aleksander)', 'title': 'muzyczna prehistoria', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': '14.10.21r - dzień wolny od zajęć dydaktycznych', 'date': '2021-12-13 12:55:55'}, {'author': 'Kowanec Maciej (Kowanec Maciej)', 'title': 'Harmonogram zajęć dodatkowych', 'date': '2021-12-13 12:55:55'}, {'author': 'Porębska Renata (Porębska Renata)', 'title': 'Jutrzejsze spotkanie z klasą', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Re: Re: Posiedzenie Rady Rodziców', 'date': '2021-12-13 12:55:55'}, {'author': 'Porębska Renata (Porębska Renata)', 'title': 'Wsparcie', 'date': '2021-12-13 12:55:55'}, {'author': 'Zawadzka Agata (Zawadzka Agata)', 'title': 'Zachowanie na wychowaniu fizycznym', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Posiedzenie Rady Rodziców', 'date': '2021-12-13 12:55:55'}, {'author': 'Golonka Michał (Golonka Michał)', 'title': 'Cwiczenia do historii', 'date': '2021-12-13 12:55:55'}, {'author': 'Woźniak-Rosiak Grażyna (Woźniak-Rosiak Grażyna)', 'title': 'kl.7a- dotyczy zajęc wychowania do życia w rodzinie', 'date': '2021-12-13 12:55:55'}, {'author': 'Porębska Renata (Porębska Renata)', 'title': 'Program wychowawczo-profilaktyczny - ankieta', 'date': '2021-12-13 12:55:55'}, {'author': 'Zawadzka Agata (Zawadzka Agata)', 'title': 'Zebranie rodziców stacjonarnie', 'date': '2021-12-13 12:55:55'}, {'author': 'Zawadzka Agata (Zawadzka Agata)', 'title': 'Zebranie online', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Szczepienia - deklaracja do 13września !!', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Szczepienia - informacja', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Procedury bezpieczeństwa od 1.09.2021r.', 'date': '2021-12-13 12:55:55'}, {'author': 'Gąsłowska Anna (Gąsłowska Anna)', 'title': 'Nowy Rok Szkolny', 'date': '2021-12-13 12:55:55'}, {'author': 'Kołodziej Agnieszka (Kołodziej Agnieszka)', 'title': 'Ramowy program obozu', 'date': '2021-12-13 12:55:55'}, {'author': 'Kołodziej Agnieszka (Kołodziej Agnieszka)', 'title': 'Zgoda na wycieczkę', 'date': '2021-12-13 12:55:55'}]


MARKS_CONST_6186174 = {"Etyka": [], "Godzina wychowawcza": [], "Historia": [{"mark_value": "n", "factor": "1", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-09-17", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-10-01", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "drzewo genealogiczne - praca w\u0142asna", "mark_date": "2021-10-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5-", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-11-21", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-12-03", "comment": "0", "correction": "0", "semester": "1"}], "Informatyka": [{"mark_value": "5", "factor": "1", "average": "tak", "category": "Kartk\u00f3wka- urz\u0105dzenia wej\u015bciowe oraz wyj\u015bciowe.", "mark_date": "2021-10-07", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "\u0106wiczenia 1.", "mark_date": "2021-10-12", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "Classroom-\u0107wiczenia", "mark_date": "2021-10-18", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "Wklejanie zdj\u0119\u0107 i praca z narz\u0119dziem Tekst", "mark_date": "2021-11-09", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "\u0106wiczenie. Nie tylko p\u0119dzlem. Pisanie i ilustrowanie tekstu", "mark_date": "2021-11-23", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "Kartk\u00f3wka. Skr\u00f3ty klawiszowe", "mark_date": "2021-12-14", "comment": "0", "correction": "0", "semester": "1"}], "J\u0119zyk angielski": [{"mark_value": "np", "factor": "0", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-09-29", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-13", "comment": "Kartk\u00f3wka 1 - rodzajniki nieokre\u015blone, odmiana czasownika to be, artyku\u0142y szkolne", "correction": "0", "semester": "1"}, {"mark_value": "5+", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-27", "comment": "Sprawdzian - Unit 1", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-03", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "1", "average": "tak", "category": "inna", "mark_date": "2021-11-15", "comment": "Kartk\u00f3wka - zadanie opisowe, opis siebie i koleg\u00f3w. ", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-11-17", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "bz", "factor": "0", "average": "0", "category": "zadanie", "mark_date": "2021-11-22", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-29", "comment": "Sprawdzian - Unit 2", "correction": "0", "semester": "1"}, {"mark_value": "bz", "factor": "0", "average": "0", "category": "zadanie", "mark_date": "2021-12-01", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "bz", "factor": "0", "average": "0", "category": "zadanie", "mark_date": "2021-12-13", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-12-14", "comment": "0", "correction": "0", "semester": "1"}], "J\u0119zyk polski": [{"mark_value": "5", "factor": "1", "average": "tak", "category": "czytanie g\u0142o\u015bne", "mark_date": "2021-09-20", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "przygotowanie do lekcji", "mark_date": "2021-09-20", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5+", "factor": "2", "average": "tak", "category": "dyktando", "mark_date": "2021-09-27", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4-", "factor": "3", "average": "tak", "category": "sprawdzian po rozdziale ", "mark_date": "2021-09-27", "comment": "Sprawdzian po I rozdziale", "correction": "0", "semester": "1"}, {"mark_value": "6", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-26", "comment": "Znajomo\u015b\u0107 lektury Akademia pana Kleksa", "correction": "0", "semester": "1"}, {"mark_value": "+", "factor": "0", "average": "0", "category": "aktywno\u015b\u0107", "mark_date": "2021-10-28", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "lektura", "mark_date": "2021-10-29", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-09", "comment": "Opis przedmiotu", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-09", "comment": "Sprawdzian po II rozdziale", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "przygotowanie do lekcji", "mark_date": "2021-11-16", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "1", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-19", "comment": "Odmiana przez przypadki", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "odpowied\u017a ", "mark_date": "2021-11-22", "comment": "Odmiana przez przypadki", "correction": "0", "semester": "1"}, {"mark_value": "np", "factor": "0", "average": "0", "category": "przygotowanie do lekcji", "mark_date": "2021-12-02", "comment": "0", "correction": "0", "semester": "1"}], "Matematyka": [{"mark_value": "5", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-09-28", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-09-30", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-18", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "praca na lekcji", "mark_date": "2021-11-14", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5+", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-18", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "tabliczka mno\u017cenia", "mark_date": "2021-11-26", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-11-27", "comment": "0", "correction": "0", "semester": "1"}], "Muzyka": [{"mark_value": "6", "factor": "1", "average": "tak", "category": "piosenka", "mark_date": "2021-09-20", "comment": "Czas powrotu", "correction": "0", "semester": "1"}], "Plastyka": [{"mark_value": "5-", "factor": "0", "average": "nie", "category": "bukiet li\u015bci", "mark_date": "2021-09-22", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "dzia\u0142alno\u015b\u0107 tw\u00f3rcza", "mark_date": "2021-10-27", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "w\u0142a\u015bciwo\u015bci barw", "mark_date": "2021-11-03", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "inna", "mark_date": "2021-11-10", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "dzia\u0142alno\u015b\u0107 tw\u00f3rcza", "mark_date": "2021-12-08", "comment": "0", "correction": "0", "semester": "1"}], "Przyroda": [{"mark_value": "5", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-10-02", "comment": "poznajemy warsztat przyrodnika ", "correction": "0", "semester": "1"}, {"mark_value": "3", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-10-12", "comment": "dzia\u0142 I", "correction": "0", "semester": "1"}, {"mark_value": "4", "factor": "2", "average": "tak", "category": "kartk\u00f3wka", "mark_date": "2021-11-09", "comment": "temat 1,2- dzia\u0142 II ", "correction": "0", "semester": "1"}, {"mark_value": "6-", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-11-18", "comment": "wiatromierz, deszczomierz", "correction": "0", "semester": "1"}, {"mark_value": "5-", "factor": "3", "average": "tak", "category": "sprawdzian", "mark_date": "2021-12-07", "comment": "dzia\u0142 II ", "correction": "0", "semester": "1"}], "Religia": [{"mark_value": "bz", "factor": "0", "average": "0", "category": "zadanie", "mark_date": "2021-09-17", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-10-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-10-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "odpowied\u017a ustna", "mark_date": "2021-11-05", "comment": "10 przykaza\u0144", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-11-08", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-12-06", "comment": "0", "correction": "0", "semester": "1"}], "Technika": [{"mark_value": "5", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-09-15", "comment": "Moja wizyt\u00f3wka - pierwsza strona mojego zeszytu - praca praktyczna", "correction": "0", "semester": "1"}, {"mark_value": "5-", "factor": "1", "average": "tak", "category": "zadanie", "mark_date": "2021-09-29", "comment": "Znaki powszechnej informacji", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "2", "average": "tak", "category": "praca indywidualna 1", "mark_date": "2021-11-03", "comment": "Pan Stop", "correction": "0", "semester": "1"}], "Wychowanie fizyczne": [{"mark_value": "5", "factor": "0", "average": "nie", "category": "Pozycje wyj\u015bciowe - \u0107w. kszta\u0142tuj\u0105ce.", "mark_date": "2021-09-30", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "1", "average": "tak", "category": "aktywno\u015b\u0107", "mark_date": "2021-10-01", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "Podania i chwyty.", "mark_date": "2021-10-29", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "Ringo - sprawdzian umiej\u0119tno\u015bci", "mark_date": "2021-11-04", "comment": "0", "correction": "0", "semester": "1"}, {"mark_value": "5", "factor": "0", "average": "nie", "category": "rozgrzewka", "mark_date": "2021-11-05", "comment": "0", "correction": "1", "semester": "1"}]}
MESSAGES_CONST_6186174 = {"author": "Ostrowski Aleksander (Ostrowski Aleksander)", "title": "Kody do zaj\u0119\u0107 z lekcji muzyyki 4b", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Odwo\u0142anie wyjazdu do kina", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Dane do Librusa i Classroom.", "date": "2021-12-09 08:31:01"}, {"author": "Kosi\u0144ska Magdalena (Kosi\u0144ska Magdalena)", "title": "Odwo\u0142ane zaj\u0119cia ko\u0142a bibliotecznego", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Pilna informacja -,,Dzie\u0144 otwarty", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Sprawy bie\u017c\u0105ce.", "date": "2021-12-09 08:31:01"}, {"author": "Zawadzka Agata (Zawadzka Agata)", "title": "Wyjazd do kina", "date": "2021-12-09 08:31:01"}, {"author": "Kowanec Maciej (Kowanec Maciej)", "title": "Zmiana przydzia\u0142u sali na lekcji 3 w dniu jutrzejszym", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Dzie\u0144 Otwarty dla Rodzic\u00f3w- 1XII 2021", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Dentobus", "date": "2021-12-09 08:31:01"}, {"author": "administrator (administrator Monika)", "title": "KR_przyjazd dentobusu w dniach 10, 13 i 14 grudnia 2021", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Matlandia", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Str\u00f3j galowy", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Procedury bezpiecze\u0144stwa", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Spotkanie z Rodzicami klas 4-8", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Wiadomo\u015b\u0107 usuni\u0119ta przez nadawc\u0119 w dniu 2021-10-25 21:45:14", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Wycieczka", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "14.10.21r - dzie\u0144 wolny od zaj\u0119\u0107 dydaktycznych", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Zaj\u0119cia dodatkowe z matematyki", "date": "2021-12-09 08:31:01"}, {"author": "Kosi\u0144ska Magdalena (Kosi\u0144ska Magdalena)", "title": "Ko\u0142o czytelnicze", "date": "2021-12-09 08:31:01"}, {"author": "Kowanec Maciej (Kowanec Maciej)", "title": "Harmonogram zaj\u0119\u0107 dodatkowych", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Wycieczka c.d.", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Wycieczka", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Legitymacja szkolne", "date": "2021-12-09 08:31:01"}, {"author": "Golonka Micha\u0142 (Golonka Micha\u0142)", "title": "\u0106wiczenia do historii", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Ankieta dla uczni\u00f3w", "date": "2021-12-09 08:31:01"}, {"author": "Wo\u017aniak-Rosiak Gra\u017cyna (Wo\u017aniak-Rosiak Gra\u017cyna)", "title": "kl.4b - dotyczy zaj\u0119\u0107 wychowania do \u017cycia w rodzinie", "date": "2021-12-09 08:31:01"}, {"author": "Por\u0119bska Renata (Por\u0119bska Renata)", "title": "Program wychowawczo-profilaktyczny - ankieta", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Zebranie z rodzicami", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Zgody na zaj\u0119cia dodatkowe", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Test diagnostyczny z matematyki", "date": "2021-12-09 08:31:01"}, {"author": "Wo\u017aniak-Rosiak Gra\u017cyna (Wo\u017aniak-Rosiak Gra\u017cyna)", "title": "kl.4b - dotyczy zaj\u0119\u0107 wychowania do \u017cycia w rodzinie", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Procedury bezpiecze\u0144stwa od 1.09.2021r.", "date": "2021-12-09 08:31:01"}, {"author": "Malara Katarzyna (Malara Katarzyna)", "title": "Rozpocz\u0119cie Roku Szkolnego", "date": "2021-12-09 08:31:01"}, {"author": "G\u0105s\u0142owska Anna (G\u0105s\u0142owska Anna)", "title": "Nowy Rok Szkolny", "date": "2021-12-09 08:31:01"}


if len(sys.argv) > 1:
    username = sys.argv[1]
    if (sys.argv[2]):
        friendly_name = sys.argv[2]
else:
    username = '4394568'
    #username = '6186174'
    friendly_name = 'R'

print(friendly_name)
print(username)



rand_time = random.randint(60,500)

options = Options()
options.add_argument("window-size=1400,600")

##setting up logger
logging.basicConfig(format='%(asctime)s %(levelname)-8s [%(filename)s:%(lineno)d] %(message)s',
                    datefmt='%d-%m-%Y %H:%M:%S',
                    level=logging.INFO,
                    filename='logs.txt')
logger = logging.getLogger('libscrap')
logger.info('Starting Librus Scrapper')


##below is chrome section - this should be moved to utils and named
##like "update marks"

s = Service('D:\python_home\chromedriver_win32\chromedriver.exe')
chrome = webdriver.Chrome(service=s, options=options)
chrome.get('https://portal.librus.pl/rodzina')
chrome.minimize_window()
page = PageParser(chrome)
time.sleep(1)
logger.info('Logging into the librus')
page.login(username,utils._sec.sec)
time.sleep(1)

##getting marks and parsing them
page.go_to_oceny()
time.sleep(2)
logger.info('Starting playing around with marks')
marks_section = page.parse_marks()
marks = MarksPage(marks_section)
all_marks = marks.all_marks

##getting messages and parsing them
page.go_to_messages()
time.sleep(1)
messages_section = page.parse_messages()
messages = MessagesPage(messages_section)

all_messages = messages.all_messages

##RUN ONLY AT FIRST TIME TO SET UP SAVED FILES
#FileOperations.save_marks_file(username, all_marks)
#FileOperations.save_messages_file(username, all_messages)


##below two lines are for testing puprpose. before enabling them you should comment all "chrome section" (line 49-73 more or less)
##when you do this you will testing on constant dictionaries definied at the beginning of this file
#all_marks = MARKS_CONST_4394568
#all_messages = MESSAGES_CONST_4394568
# all_marks = MARKS_CONST_6186174
# all_messages = MESSAGES_CONST_6186174

##reading saved data from files
saved_marks = FileOperations.load_marks_file(username)
saved_messages = FileOperations.load_messages_file(username)

##generating messages for telegram bot
message_marks = MarksLogic.generate_marks_change_message(all_marks, saved_marks)
message_messages = MessagesLogic.generate_messages_change_message(all_messages, saved_messages)


##sending messages if not empty
if len(message_marks) > 0:
    Message.send_message(friendly_name, [message_marks])
else:
    a = 0
    for key in all_marks.keys():
        for mark in all_marks[key]:
            a +=1
            pass

    test_msg = f'Pobrana ilosc ocen: {a}'
    logger.info(f'Pobrana ilosc ocen: {a}')
    #Message.send_message(friendly_name,[test_msg])

if len(message_messages) > 0:
    #print(message_messages)
    Message.send_message(friendly_name,[message_messages])

time.sleep(2)

#saving new data to files.
FileOperations.save_marks_file(username, all_marks)
FileOperations.save_messages_file(username, all_messages)

try:
    chrome.close()
    chrome.quit()
except:
    pass

logger.info('Exiting Librus Scrapper')
sys.exit(0)